# 디렉토리 해시 매니페스트 도구

디렉토리의 파일 해시 매니페스트를 생성하고, 나중에 이 매니페스트와 비교하여 변경 사항을 탐지하는 Python 스크립트입니다. 파일 무결성 검증, 디렉토리 변경 사항 추적, 또는 파일 전송 성공 여부 확인에 유용합니다.

## 설명

이 도구는 두 가지 주요 기능을 제공합니다:

1. **매니페스트 생성 (`-o`, `--output`):** 디렉토리를 재귀적으로 스캔하여 모든 파일의 상대 경로와 SHA256 해시가 포함된 JSON 파일(`매니페스트`)을 생성합니다.
2. **매니페스트와 비교 (`-c`, `--compare`):** 디렉토리의 파일들을 이전에 생성된 매니페스트 파일과 비교합니다. 매니페스트가 생성된 이후 추가, 제거 또는 수정된 파일이 있는지 보고합니다.

## 요구 사항

- Python 3.6 이상
- 별도의 외부 라이브러리가 필요하지 않습니다.

## 사용법

터미널 또는 명령 프롬프트에서 모든 명령을 실행합니다.

### 해시 매니페스트 생성하기

`data` 디렉토리의 파일에 대한 `hashes.json` 파일을 생성하려면:

```bash
python hasher.py --output hashes.json --directory ./data
```

`--directory` 인자를 생략하면 기본적으로 현재 디렉토리를 스캔합니다.

```bash
# 현재 디렉토리에 'manifest.json' 생성
python hasher.py -o manifest.json
```

### 매니페스트와 디렉토리 비교하기

`data` 디렉토리의 변경 사항을 `hashes.json` 매니페스트와 비교하려면:

```bash
python hasher.py --compare hashes.json --directory ./data
```

출력에는 추가, 제거 또는 수정된 파일이 명확하게 목록으로 표시됩니다. 변경 사항이 없으면 없다고 보고합니다.

### 커맨드 라인 인자

- `-o, --output <파일 경로>`: **생성 모드**. 새로운 해시 매니페스트를 생성하여 지정된 파일 경로에 저장합니다.
- `-c, --compare <파일 경로>`: **비교 모드**. 대상 디렉토리를 지정된 매니페스트 파일과 비교합니다.
- `-d, --directory <디렉토리 경로>`: 스캔할 대상 디렉토리를 지정합니다. 지정하지 않으면 현재 디렉토리 (`.`)가 기본값입니다.

## 향후 개선 아이디어

향후 추가될 수 있는 잠재적인 개선 사항은 다음과 같습니다:

- **무시 패턴:** `.gitignore`와 유사한 `.ignore` 파일을 읽어 해시 프로세스에서 특정 파일이나 디렉토리를 제외하는 기능 추가.
- **다양한 해시 알고리즘:** 커맨드 라인 플래그를 통해 사용자가 다른 해시 알고리즘(예: MD5, SHA1)을 선택할 수 있도록 허용.
- **상세 모드(Verbose Mode):** 처리 중인 모든 파일을 출력하는 `-v` 또는 `--verbose` 플래그를 포함하여 대용량 디렉토리에 유용할 수 있음.
- **매니페스트 업데이트:** 새 파일을 덮어쓰는 대신 기존 매니페스트 파일을 업데이트하는 기능을 추가하여 변경 사항이 적은 대용량 디렉토리에서 더 효율적일 수 있음.
- **GUI:** 기술적이지 않은 사용자를 위해 생성 및 비교 작업을 수행할 수 있는 간단한 그래픽 사용자 인터페이스 개발.

## Docker 사용법

Docker를 사용하면 호스트 머신에 Python을 설치하지 않고도 스크립트를 실행할 수 있습니다. 제공된 `Dockerfile`이 필요한 환경을 설정합니다.

### 1. Docker 이미지 빌드하기

먼저, 프로젝트 루트에서 `Dockerfile`로 이미지를 빌드합니다:

```bash
docker build -t directory-hasher .
```

### 2. 컨테이너 실행하기

스크립트를 사용하려면 스캔하려는 호스트 디렉토리를 컨테이너에 마운트해야 합니다. 호스트 디렉토리를 컨테이너 내부의 `/app/data` 디렉토리에 마운트할 것입니다.

**매니페스트 생성하기:**

```bash
docker run --rm -v "C:\your\data\path:/app/data" directory-hasher -o data/manifest.json -d data
```

- `--rm`: 컨테이너 실행이 끝나면 자동으로 삭제합니다.
- `-v "C:\your\data\path:/app/data"`: 로컬 디렉토리를 컨테이너에 마운트합니다. **`C:\your\data\path`를 여러분의 대상 디렉토리의 절대 경로로 반드시 변경해야 합니다.**
- `directory-hasher`: 방금 빌드한 이미지의 이름입니다.
- `-o data/manifest.json -d data` 인자는 스크립트에 전달되며, 경로는 컨테이너의 작업 디렉토리(`/app`) 기준입니다. 출력 파일 `manifest.json`은 마운트된 볼륨에 있으므로 호스트 디렉토리에 저장됩니다.

**매니페스트와 비교하기:**

```bash
docker run --rm -v "C:\your\data\path:/app/data" directory-hasher -c data/manifest.json -d data
```

명령어는 매우 유사합니다. 스크립트는 호스트에 마운트된 디렉토리에서 매니페스트 파일을 읽어와 비교를 수행합니다.